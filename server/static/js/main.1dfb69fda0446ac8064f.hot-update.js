webpackHotUpdate("main",{

/***/ "./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js?!./src/page/chat/ChatBox.vue?vue&type=script&lang=js&":
/*!**********************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/page/chat/ChatBox.vue?vue&type=script&lang=js& ***!
  \**********************************************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var socket_io_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! socket.io-client */ \"./node_modules/socket.io-client/lib/index.js\");\n/* harmony import */ var socket_io_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(socket_io_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _friendBox_vue__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./friendBox.vue */ \"./src/page/chat/friendBox.vue\");\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  name: 'chatbox',\n  components: {\n    FriendBox: _friendBox_vue__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\n  },\n  data() {\n    return {\n      user: '',\n      userList: null,\n      socket: null,\n      isChatOpen: false,\n      currentFirend: '',\n      msgStore: {},\n      message: '',\n      unread: {}\n    };\n  },\n  created() {\n    let user = USER.user;\n    this.user = user;\n    const socket = socket_io_client__WEBPACK_IMPORTED_MODULE_0___default()('http://127.0.0.1:8888/?user=' + user);\n    this.socket = socket;\n    let msgStore = this.msgStore;\n\n    socket.on('userList', data => {\n      console.log(data);\n      this.userList = data;\n    });\n    socket.on('sys', function (data) {\n      console.log(data);\n    });\n    socket.on('msg', data => {\n      console.log('recive:', data);\n\n      //处理未读消息\n      this.processUnread(data);\n\n      let friend = data.from;\n      if (msgStore && !msgStore[friend]) {\n        this.$set(msgStore, friend, []);\n      }\n      //更新为本地收到消息的时间\n      data.time = new Date().getTime();\n      msgStore[friend].push(data);\n      this.keepBottom();\n    });\n  },\n  methods: {\n    processUnread(reciveData) {\n      let friend = reciveData.from;\n      if (friend != this.currentFirend) {\n        var num = this.unread[friend] ? this.unread[friend] : 0;\n        this.$set(this.unread, friend, ++num);\n      }\n    },\n    openChat(id, friend) {\n      if (this.user == friend) {\n        return;\n      }\n      this.isChatOpen = true;\n      this.keepBottom();\n      this.unread[friend] = 0;\n      this.currentFirend = friend;\n      console.log(id, friend);\n    },\n    sendMsg() {\n      let friend = this.currentFirend;\n      let msgStore = this.msgStore;\n      let msgBody = {\n        message: this.message,\n        time: new Date().getTime(),\n        from: USER.user,\n        to: friend\n      };\n      const socket = this.socket;\n      if (msgStore && !msgStore[friend]) {\n        this.$set(msgStore, friend, []);\n      }\n      //本地储存消息\n      msgStore[friend].push(msgBody);\n      //发送到服务器中转\n      socket.emit('msg', msgBody);\n      console.log(this.message);\n      this.keepBottom();\n      //清空输入框\n      this.message = '';\n    },\n    keepBottom() {\n      let displayBox = document.querySelector('.display-box');\n      setTimeout(function () {\n        displayBox.scrollTop = displayBox.scrollHeight;\n      });\n    }\n  }\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYmFiZWwtbG9hZGVyL2xpYi9pbmRleC5qcyEuL25vZGVfbW9kdWxlcy92dWUtbG9hZGVyL2xpYi9pbmRleC5qcz8hLi9zcmMvcGFnZS9jaGF0L0NoYXRCb3gudnVlP3Z1ZSZ0eXBlPXNjcmlwdCZsYW5nPWpzJi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9DaGF0Qm94LnZ1ZT81YzcwIl0sInNvdXJjZXNDb250ZW50IjpbIjx0ZW1wbGF0ZT5cbiAgPGRpdiBpZD0nY2hhdCc+XG4gICAgPEZyaWVuZEJveCA6dXNlckxpc3Q9J3VzZXJMaXN0JyA6dW5yZWFkPSd1bnJlYWQnIDpjdXJyZW50RnJpZW5kPSdjdXJyZW50RmlyZW5kJyBAc3RhcnRDaGF0PVwib3BlbkNoYXRcIj48L0ZyaWVuZEJveD5cbiAgICA8ZGl2IGNsYXNzPSdjaGF0aW5nJyB2LWlmPSdpc0NoYXRPcGVuJz5cbiAgICAgIDxkaXYgY2xhc3M9J3RpdGxlJz7mraPlnKjlkox7e2N1cnJlbnRGaXJlbmR9feiBiuWkqTwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cImRpc3BsYXktYm94XCI+XG4gICAgICAgIDx1bD5cbiAgICAgICAgICA8bGkgdi1mb3I9J2l0ZW0gaW4gbXNnU3RvcmVbY3VycmVudEZpcmVuZF0nIDpjbGFzcz0nW2l0ZW0uZnJvbSA9PSB1c2VyID8gXCJzZWxmLW1lc3NhZ2VcIiA6IFwiZnJpZW5kLW1lc3NhZ2VcIl0nIGNsYXNzPSdtZXNzYWdlLWl0ZW0nPlxuICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSdhdmF0YXInPjwvc3Bhbj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9J21lc3NhZ2UnPlxuICAgICAgICAgICAgICAge3tpdGVtLm1lc3NhZ2V9fVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9saT5cbiAgICAgICAgPC91bD5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz0naW5wdXQtem9uZSc+XG4gICAgICAgIDx0ZXh0YXJlYSB2LW1vZGVsPVwibWVzc2FnZVwiIEBrZXl1cC5lbnRlcj1cInNlbmRNc2dcIj48L3RleHRhcmVhPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuPC90ZW1wbGF0ZT5cbjxzY3JpcHQ+XG5pbXBvcnQgU29ja2V0SU8gZnJvbSAnc29ja2V0LmlvLWNsaWVudCdcbmltcG9ydCBGcmllbmRCb3ggZnJvbSAnLi9mcmllbmRCb3gudnVlJ1xuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOidjaGF0Ym94JyxcbiAgY29tcG9uZW50czoge1xuICAgIEZyaWVuZEJveFxuICB9LFxuICBkYXRhICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdXNlcjogJycsXG4gICAgICB1c2VyTGlzdDogbnVsbCxcbiAgICAgIHNvY2tldDogbnVsbCxcbiAgICAgIGlzQ2hhdE9wZW46IGZhbHNlLFxuICAgICAgY3VycmVudEZpcmVuZDogJycsXG4gICAgICBtc2dTdG9yZToge30sXG4gICAgICBtZXNzYWdlOiAnJyxcbiAgICAgIHVucmVhZDoge31cbiAgICB9XG4gIH0sXG4gIGNyZWF0ZWQgKCkge1xuICAgIGxldCB1c2VyID0gVVNFUi51c2VyXG4gICAgdGhpcy51c2VyID0gdXNlclxuICAgIGNvbnN0IHNvY2tldCA9ICBTb2NrZXRJTygnaHR0cDovLzEyNy4wLjAuMTo4ODg4Lz91c2VyPScgKyB1c2VyKVxuICAgIHRoaXMuc29ja2V0ID0gc29ja2V0XG4gICAgbGV0IG1zZ1N0b3JlID0gdGhpcy5tc2dTdG9yZVxuXG4gICAgc29ja2V0Lm9uKCd1c2VyTGlzdCcsIChkYXRhKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhkYXRhKVxuICAgICAgdGhpcy51c2VyTGlzdCA9IGRhdGFcbiAgICB9KVxuICAgIHNvY2tldC5vbignc3lzJywgZnVuY3Rpb24oZGF0YSl7XG4gICAgICBjb25zb2xlLmxvZyhkYXRhKVxuICAgIH0pXG4gICAgc29ja2V0Lm9uKCdtc2cnLCAoZGF0YSkgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ3JlY2l2ZTonLGRhdGEpXG5cbiAgICAgIC8v5aSE55CG5pyq6K+75raI5oGvXG4gICAgICB0aGlzLnByb2Nlc3NVbnJlYWQoZGF0YSlcblxuICAgICAgbGV0IGZyaWVuZCA9IGRhdGEuZnJvbVxuICAgICAgaWYobXNnU3RvcmUgJiYgIW1zZ1N0b3JlW2ZyaWVuZF0pe1xuICAgICAgICB0aGlzLiRzZXQobXNnU3RvcmUsIGZyaWVuZCwgW10pXG4gICAgICB9XG4gICAgICAvL+abtOaWsOS4uuacrOWcsOaUtuWIsOa2iOaBr+eahOaXtumXtFxuICAgICAgZGF0YS50aW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKClcbiAgICAgIG1zZ1N0b3JlW2ZyaWVuZF0ucHVzaChkYXRhKVxuICAgICAgdGhpcy5rZWVwQm90dG9tKClcbiAgICB9KVxuXG4gIH0sXG4gIG1ldGhvZHM6IHtcbiAgICBwcm9jZXNzVW5yZWFkIChyZWNpdmVEYXRhKSB7XG4gICAgICBsZXQgZnJpZW5kID0gcmVjaXZlRGF0YS5mcm9tXG4gICAgICBpZihmcmllbmQgIT0gdGhpcy5jdXJyZW50RmlyZW5kKXtcbiAgICAgICAgdmFyIG51bSA9IHRoaXMudW5yZWFkW2ZyaWVuZF0gPyB0aGlzLnVucmVhZFtmcmllbmRdIDogMFxuICAgICAgICB0aGlzLiRzZXQodGhpcy51bnJlYWQsIGZyaWVuZCwgKytudW0pXG4gICAgICB9XG4gICAgfSxcbiAgICBvcGVuQ2hhdCAoaWQsIGZyaWVuZCl7XG4gICAgICBpZih0aGlzLnVzZXIgPT0gZnJpZW5kKXtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICB0aGlzLmlzQ2hhdE9wZW4gPSB0cnVlXG4gICAgICB0aGlzLmtlZXBCb3R0b20oKVxuICAgICAgdGhpcy51bnJlYWRbZnJpZW5kXSA9IDBcbiAgICAgIHRoaXMuY3VycmVudEZpcmVuZCA9IGZyaWVuZFxuICAgICAgY29uc29sZS5sb2coaWQsIGZyaWVuZClcbiAgICB9LFxuICAgIHNlbmRNc2coKSB7XG4gICAgICBsZXQgZnJpZW5kID0gdGhpcy5jdXJyZW50RmlyZW5kXG4gICAgICBsZXQgbXNnU3RvcmUgPSB0aGlzLm1zZ1N0b3JlXG4gICAgICBsZXQgbXNnQm9keSA9IHtcbiAgICAgICAgbWVzc2FnZTogdGhpcy5tZXNzYWdlLFxuICAgICAgICB0aW1lOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSxcbiAgICAgICAgZnJvbTogVVNFUi51c2VyLFxuICAgICAgICB0bzogZnJpZW5kXG4gICAgICB9XG4gICAgICBjb25zdCBzb2NrZXQgPSB0aGlzLnNvY2tldFxuICAgICAgaWYobXNnU3RvcmUgJiYgIW1zZ1N0b3JlW2ZyaWVuZF0pe1xuICAgICAgICB0aGlzLiRzZXQobXNnU3RvcmUsIGZyaWVuZCwgW10pXG4gICAgICB9XG4gICAgICAvL+acrOWcsOWCqOWtmOa2iOaBr1xuICAgICAgbXNnU3RvcmVbZnJpZW5kXS5wdXNoKG1zZ0JvZHkpXG4gICAgICAvL+WPkemAgeWIsOacjeWKoeWZqOS4rei9rFxuICAgICAgc29ja2V0LmVtaXQoJ21zZycsIG1zZ0JvZHkpXG4gICAgICBjb25zb2xlLmxvZyh0aGlzLm1lc3NhZ2UpXG4gICAgICB0aGlzLmtlZXBCb3R0b20oKVxuICAgICAgLy/muIXnqbrovpPlhaXmoYZcbiAgICAgIHRoaXMubWVzc2FnZSA9ICcnXG4gICAgfSxcbiAgICBrZWVwQm90dG9tICgpIHtcbiAgICAgIGxldCBkaXNwbGF5Qm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRpc3BsYXktYm94JylcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgZGlzcGxheUJveC5zY3JvbGxUb3AgPSBkaXNwbGF5Qm94LnNjcm9sbEhlaWdodFxuICAgICAgfSlcbiAgICB9XG4gIH1cbn1cbjwvc2NyaXB0PlxuPHN0eWxlPlxuI2NoYXQge1xuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiAxMDAlO1xuICBkaXNwbGF5OiBmbGV4O1xuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI0MywgMjQ3LCAyNDgsIDEpO1xufVxuLmNoYXRpbmd7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gIGZsZXg6MTtcbiAgXG59XG4uY2hhdGluZyAudGl0bGV7XG4gIHdpZHRoOiAxMDAlO1xuICBoZWlnaHQ6IDYwcHg7XG4gIGxpbmUtaGVpZ2h0OiA2MHB4O1xuICBwYWRkaW5nLWxlZnQ6IDE1cHg7XG4gIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjOThBM0FEO1xufVxuLmNoYXRpbmcgLmRpc3BsYXktYm94e1xuICBoZWlnaHQ6IDEwMCU7XG4gIHdpZHRoOiAxMDAlO1xufVxuLmNoYXRpbmcgLmlucHV0LXpvbmV7XG4gIGhlaWdodDogNDBweDtcbiAgd2lkdGg6IDEwMCU7XG4gIGJvcmRlci10b3A6IDFweCBzb2xpZCAjY2NjO1xufVxuLmNoYXRpbmcgLmlucHV0LXpvbmUgdGV4dGFyZWF7XG4gIGRpc3BsYXk6IGJsb2NrO1xuICB3aWR0aDogOTglO1xuICAvKiBoZWlnaHQ6IDEwMCU7ICovXG4gIGJvcmRlcjogbm9uZTtcbiAgb3V0bGluZTogbm9uZTtcbiAgcmVzaXplOiBub25lO1xuICB0ZXh0LWluZGVudDogNXB4O1xufVxuLmRpc3BsYXktYm94e1xuICBvdmVyZmxvdy15OiBhdXRvO1xufVxuLm1lc3NhZ2UtaXRlbXtcbiAgd2lkdGg6IDEwMCU7XG4gIHBhZGRpbmc6IDE1cHggMDtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcbn1cbi5zZWxmLW1lc3NhZ2V7XG4gIHRleHQtYWxpZ246IHJpZ2h0O1xufVxuLmZyaWVuZC1tZXNzYWdle1xuICB0ZXh0LWFsaWduOiBsZWZ0O1xufVxuLnNlbGYtbWVzc2FnZSAuYXZhdGFye1xuICB3aWR0aDogMzBweDtcbiAgaGVpZ2h0OiAzMHB4O1xuICBib3JkZXItcmFkaXVzOiAyMHB4O1xuICBiYWNrZ3JvdW5kOiBncmF5OztcbiAgbWFyZ2luOiAwcHggMTBweCAwIDE1cHg7XG4gIGZsb2F0OiByaWdodDtcbn1cbi5zZWxmLW1lc3NhZ2UgLm1lc3NhZ2V7XG4gIGZsb2F0OiByaWdodDtcbiAgaGVpZ2h0OiAzMHB4O1xuICBsaW5lLWhlaWdodDogMzBweDtcbiAgYm9yZGVyLXJhZGl1czogMTBweDtcbiAgcGFkZGluZzogMCAxMHB4O1xuICBjb2xvcjogI2ZmZjtcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSg1MCwgMjEzLCAxNDAsIDEpO1xufVxuLmZyaWVuZC1tZXNzYWdlIC5hdmF0YXJ7XG4gIHdpZHRoOiAzMHB4O1xuICBoZWlnaHQ6IDMwcHg7XG4gIGJvcmRlci1yYWRpdXM6IDIwcHg7XG4gIGJhY2tncm91bmQ6IGdyYXk7O1xuICBtYXJnaW46IDBweCAxMHB4IDAgMTVweDtcbiAgZmxvYXQ6IGxlZnQ7XG59XG4uZnJpZW5kLW1lc3NhZ2UgLm1lc3NhZ2V7XG4gIGZsb2F0OiBsZWZ0O1xuICBoZWlnaHQ6IDMwcHg7XG4gIGxpbmUtaGVpZ2h0OiAzMHB4O1xuICBib3JkZXItcmFkaXVzOiAxMHB4O1xuICBwYWRkaW5nOiAwIDEwcHg7XG4gIGNvbG9yOiAjYWFhO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDEpO1xufVxuPC9zdHlsZT4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBc0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE3Q0E7QUFoREEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js?!./src/page/chat/ChatBox.vue?vue&type=script&lang=js&\n");

/***/ })

})